<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mini GTA</title>
<style>
    body { margin: 0; overflow: hidden; }
</style>
</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>

// === СЦЕНА ===
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

// === КАМЕРА ===
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0, 5, 10);

// === РЕНДЕР ===
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// === СВЕТ ===
const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(10, 10, 10);
scene.add(light);

// === ЗЕМЛЯ ===
const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(100, 100),
    new THREE.MeshStandardMaterial({ color: 0x228B22 })
);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

// === ИГРОК ===
const player = new THREE.Mesh(
    new THREE.BoxGeometry(1,2,1),
    new THREE.MeshStandardMaterial({ color: 0x0000ff })
);
player.position.y = 1;
scene.add(player);

// === МАШИНА ===
const car = new THREE.Mesh(
    new THREE.BoxGeometry(2,1,4),
    new THREE.MeshStandardMaterial({ color: 0xff0000 })
);
car.position.set(5,0.5,0);
scene.add(car);

// === УПРАВЛЕНИЕ ===
let moveX = 0;
let moveZ = 0;
let inCar = false;

document.addEventListener("keydown", (e)=>{
    if(e.key === "w") moveZ = -1;
    if(e.key === "s") moveZ = 1;
    if(e.key === "a") moveX = -1;
    if(e.key === "d") moveX = 1;

    if(e.key === "e"){
        const dist = player.position.distanceTo(car.position);
        if(dist < 3) inCar = !inCar;
    }
});

document.addEventListener("keyup", ()=>{
    moveX = 0;
    moveZ = 0;
});

// === АНИМАЦИЯ ===
function animate(){
    requestAnimationFrame(animate);

    if(inCar){
        car.position.x += moveX * 0.15;
        car.position.z += moveZ * 0.15;

        camera.position.lerp(
            new THREE.Vector3(car.position.x, car.position.y+5, car.position.z+10),
            0.1
        );
        camera.lookAt(car.position);

    } else {
        player.position.x += moveX * 0.1;
        player.position.z += moveZ * 0.1;

        camera.position.lerp(
            new THREE.Vector3(player.position.x, player.position.y+5, player.position.z+10),
            0.1
        );
        camera.lookAt(player.position);
    }

    renderer.render(scene, camera);
}

animate();

</script>
</body>
</html>
